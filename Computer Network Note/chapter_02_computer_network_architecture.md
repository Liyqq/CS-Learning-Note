## 2.1 网络体系结构的基本思想

### 分层思想

​		将一个庞大、复杂的问题**分解**为若干个功能相对单一、结构比较简单、处理更为方便的**局部问题**，并分别解决。这种**“化整为零”**的思想就是分层思想。

​		在计算机网络体系结构中，分层思想表现为：**网络中每层基于自己的下层提供服务的支持下，通过自身内部功能实现一种或几种特定的服务。**

#### 分层思想的优点

* **耦合性低（独立性强）**：每层只需调用下层的接口，而无需关心其实现。
* **适应性强**：只要每层提供的服务和接口不变，其内部实现细节就可任意改变。
* **易于实现与维护**：将复杂系统分割为功能单一简单的子系统，使得系统结构更加清晰，系统的实现、调试和维护变得更加简单和容易

---

## 2.2 计算机网络体系结构

### 2.2.1 定义

​		**计算机网络中的各个层以及层与层之间的接口、协议的集合**称为计算机网络体系结构。计算机网络体系结构是这个计算机网络及其构件所应完成的功能的精确定义。

> 体系结构是抽象的，而实现则是具体的，是真正运行的计算机硬件和软件。

### 2.2.2 基本概念

* **实体(Entity)：**表示任何可以发送或接收信息的硬件或软件进程。

* **协议(Protocol)**：控制两个对等实体（或多个实体）进行通信的规则的**集合**。

* **服务(Service)**：在协议的控制下，使得本层次两个实体间通信能**向上层提供服务**，而要实现本层次的协议，则需要**下一层提供的服务支持**，且只有能够被高层实体看得见的功能才称之为服务

    > 协议是水平的，而服务是垂直的，下面的协议对于上层实体来说是透明的。

* **服务原语(Service Primitive)**：上层为使用下层提供的服务，必须通过与下层交换一些**命令**，在**OSI**中将其称为服务用语。

* **服务访问点(Service Access Point, SAP)**：在同一系统中相邻两层之间实体进行交互（交换信息）的地方，通常称之为服务访问点，是一个抽象概念，实际上是一个逻辑接口。

任何两层之间的关系可以概括为下图所示：

<img src="src\image-20211019235317879.png" alt="image-20211019235317879" style="zoom:80%;" />

> 同一网络中的任意两个端系统必须处在**同一层次**才可”通信“，**非对等层之间不可”通信“**，除最底层进程实际的物理通信外，其余对等层之间的通信均为**逻辑通信**。

---

## 2.3网络协议

### 2.3.1 定义

​		**网络协议(Network Protocol)是网络中对等实体之间为完成数据交换所必须遵循的规则，约定和标准。**

### 2.3.2 协议“三要素”

* **语法**：指**数据与控制信息（协议元素）的结构或组合格式**，即报文格式。

* **语义**：指对协议中各种**协议元素的含义的解释**。

* **时序（同步）**：指在通信过程中，通信两方操作**执行的顺序与规则**。

​		**语法是语义的载体，时序又是对语义的有序组织。**语法规定了报文格式，语义赋予报文特定内涵，时序通过控制具有特定语义报文的交换实现计算机之间的通信。

### 2.3.3 协议数据单元

​		在计算机网络体系结构中，各对等层实体之间交换的信息报文统称为**协议数据单元(Protocol Data Unit, PDU)**。PDU由**协议控制信息**（协议头）和**数据(Service Data Unit)**两部分组成。

* 协议头：包含完成信息传输所需的控制信息。如地址、序号和标志等控制信息。
* 数据：需要传输的数据。

---

## 2.4 网络体系结构模型

### 2.4.1 OSI参考模型

​		国际标准化组织在1997年提出的一个试图使得各种计算机在世界范围内连成网络的标准框架，即**开放系统互联基本参考模型(Open System Interconnection Reference Model, OSI/RM)**，简称为**OSI**。也就是著名的**七层**协议网络体系结构，下图简略展示其结构。

<img src="src\image-20211020004412893.png" alt="image-20211020004412893" style="zoom:90%;" />

####  应用层(Application Layer)

​		应用层是**计算机用户以及各种应用程序和网络之间的接口**，其功能是直接向用户提供服务并完成用户希望在网络上完成的各项工作。

* 任务：为用户的应用程序提供网络通信服务。
* 服务：具有可以完成和实现用户请求的各种服务。
* 功能：用户应用程序与网络之间的接口，使应用程序可以和网络进行交互。
* 协议：VTP、FTAM、EDI、MHS、...

####  表示层(Presentation Layer)

​		表示层是**对上层数据或命令进行解释**以保证一个主机应用层信息可以被另一个主机的应用程序理解。

* 任务：使得应用程序能够理解数据报文的真正含义。
* 服务：数据加密、压缩、格式转换等服务。
* 功能：对数据进行编码、编译、加密、转换。
* 协议：HTTP、FTP、Telnet、...

#### 会话层(Session Layer)

​		会话层是应用程序和网络之间的接口，**负责网络中的两个节点直接的建立、维护和终止通信**。

* 任务：向两个实体的表示层提供建立和使用连接的接口。
* 服务：会话连接的建立和释放、通信方式管理（半双工、全双工）、会话单元分割和主同步、数据传输异常中断恢复等。
* 功能：建立、管理、维持、协调和结束会话。
* 协议：SSH、ADSP、ASP、SQL、NetBIOS、RPC、...

####  传输层(Transport Layer)

​		**传输层是通信子网与资源子网的分界层，是两者的接口桥梁。向高层屏蔽数据通信的所有细节，为用户提供透明的报文传输，保证报文可靠地、正确地传输。**

* 任务：**提供端到端的可靠的透明数据传输，使上层服务用户不必关心通信子网的实现细节。**
* 服务：提供面向连接和面向无连接的传输服务。
* 功能：**传输连接管理**，包括连接建立、维护和结束等；**传输差错处理**，包括差错控制、流量控制和数据重发等。
* 协议：TCP、UDP、SPX、...

####  网络层(Network Layer)

​		网络层是**通信子网的最高层，在下两层的基础上向资源子网提供服务**。在选择路由时，网络层将综合考虑优先权、网络拥塞程度、服务质量以及路由代价等决定一个结点到另一个结点的最佳路径。

* 任务：**将网络地址翻译成对应物理地址**，并通过路由选择算法为分组通过通信子网**选择最佳传输路径**。
* 服务：提供基于逻辑地址的寻址和不同网络间的路由选择。
* 功能：逻辑地址寻址，路由选择，流量控制等。
* 协议：IP、IPX、RIP、ICMP、ARP/RARP、...

####  数据链路层(Data Link Layer)

​		**负责建立和管理结点间的链路，控制网络层和网络层之间的通信**。通过差错控制、流量控制方法，**在不可靠的物理介质上提供可靠的数据传输**。

* 任务：数据链路层可细分为**介质访问控制(Media Access Control. MAC)**和**逻辑链路控制(Logical Link Control)**两个子层。
    * 介质访问控制(Media Access Control. MAC)：解决共享型网络中信道竞争问题，以及网络介质的访问控制。
    * 逻辑链路控制(Logical Link Control)：**建立和维护网络连接**，执行差错校验、流量控制和链路控制。
* 服务：向上层提供可靠、无差错的结点间数据传输链路。
* 功能：物理地址寻址、数据的成帧、流量控制、差错控制。
* 协议：Wi-Fi、WiMAX、HDLC、PPP、ATM、令牌环、以太网、...

####  物理层(Physical Layer)

​		物理层是OSI最底层，是**真正将数据在物理传输媒介上进行传输**的层次。其上层实现在物理介质上正确、透明的传送**比特流**。

* 任务：规定激活、维持、关闭通信端点之间的机械特性、电气特性、功能特性以及过程特性，为**上层协议提供一个传输数据的物理媒体**。**在物理介质上正确地、透明地传送比特流**。
* 服务：为上层提供正确、透明的结点间数据传输介质。
* 功能：实现相邻计算机结点之间比特流的透明传送，向上层屏蔽具体传输介质和物理设备的差异。
* 协议：ETA/TIA RS-232、V.35、RJ-45、...



下图详细展示了OSI七层模型中协议以及他们之间的联系。

<img src="src\image-20211020160908703.png" alt="image-20211020160908703" style="zoom:150%;" />



#### 数据传输过程

​		发送进程各层从上到下的传送到物理媒体，通过物理媒体传输到接收方，在经接收方各层从下到上的传递到目的地。这个过程中会有对**控制信息**的**封装(Encapsulation)**和**解封装(Decapsulation)**的过程。

* **封装(Encapsulation)**：发送方在**从上到下传递信息**时，下层会对上层数据进行控制信息的封装，以便完成本层次的传输任务。
* **解封装(Decapsulation)**：接收方**从下到上接收消息**时正好相反，逐层剥去发送方相应层上的封装的控制信息，这个过程被称之为。

下图展示了这个过程。

<img src="src\image-20211020163500348.png" alt="image-20211020163500348" style="zoom:80%;" />

> OSI参考模型虽然著名，但是却并未在实际工程应用中得到实现，人们更多只是将其作为一个标准的模型来使用。

### 2.4.2 TCP/IP模型

​		TCP/IP模型又称为**Internet模型**或**TCP/IP协议簇**，是目前世界上绝大多数实际使用中的网络所采用的国际标准。如果说OSI参考模型是**法律意义**上的国际标准，那么TCP/IP模型便是**实际意义**上的国际标准。

​		Internet模型的体系结构共分为四层，分别是**应用层(Application Layer)**、**传输层(Transport Layer)**、**网际层(Internet Layer)**和**网络接口层(Network Interface Layer)**。

​		Internet模型与OSI模型有许多相似之处，将OSI模型一些层合并之后便是Internet模型的相应层，下图展示了两者层与层之间的关系。

<img src="src\image-20211020165132142.png" alt="image-20211020165132142" style="zoom: 70%;" />

#### 应用层(Application Layer)

​		TCP/IP模型的应用层大致对应于OSI参考模型的**应用层**、**表示层**和**会话层**。该层协议主要包括有：

* **FTP(File Transfer Protocol)**：文件传输协议
* **HTTP(Hyper Text Transfer Protocol)**：超文本传输协议
* **STMP(Simple Mail Transfer Protocol)**：简单报文传输协议
* **Telnet**：远程网络登录协议
* **DNS(Domain Name System)**：域名服务

#### 传输层(Transport Layer)

​		大体上对应OSI参考模型的**传输层**。该层的协议主要包括有：

* **TCP(Transmission Control Protocol)**：传输控制协议，是将报文以**字节流(Byte Stream)**的形式从源主机进程发送到目的主机的进程的**可靠**的、**面向连接**的协议。
* **UDP(User Datagram Protocol)**：用户数据报协议，提供面向事务的简单**不可靠**信息传送服务，是一个**面向无连接**的协议。

#### 网际层(Internet Layer)

​		大体上对应OSI参考模型**的网络层**。该层的协议是：

* **IP(Internet Protocol)**：IP协议是TCP/IP体系结构的**核心协议**，其将IP**分组**以数据报的形式从源主机发送到目的主机。

#### 网络接口层(Network Interface Layer)

​		大体上对应OSI参考模型的**数据链路层**和**物理层**。由于构成网络的底层物理网络是各种各样的，因此**TCP/IP模型并未规定子网协议**。常见的子网协议有：

* **Ethernet**：以太网协议
* **PPP(Point-to-Point Protocol)**：点对点协议，通常用在两节点间建立直接的连接。
* **SATNET**：卫星网协议
* **FDDI(Fiber Distributed Data Interface)**：光纤分布式数据接口

#### 特点

​		Internet模型能迅速发展并成为事实上的国际标准主要是因为**它契合了世界范围内数据通信的需求**。它的主要特点有：

* **开放性**：协议标准完全开放，供用户免费使用
* **独立性**：独立于特定的网络软硬件系统，可以运行在广域网，更适合互联网。
* **统一性**：网络地址统一分配，网络中每一个设备和终端都具有一个唯一的地址。
* **标准化**：高层协议标准化，可提供多种多样可靠的网络服务。

​		TCP/IP模型还有一个显著的特点是**两头大中间小**，形似一个"**沙漏**"。这是因为**TCP/IP模型以IP为核心，且核心也较为简单**；而能承载IP分组的子网多种多样，IP支持的应用服务也多种多样。**IP具有强大的融合上下两头的能力**。下图形象的展示了TCP/IP模型的这个特点。

<img src="src\image-20211020180106639.png" alt="image-20211020180106639" style="zoom: 45%;" />

#### 数据传输过程

​		TCP/IP模型的传送过程同样有OSI模型数据传输过程中的数据封装和解封装过程。下图展示了工作的过程。

<img src="src\image-20211020175121925.png" alt="image-20211020175121925" style="zoom: 75%;" />



### 2.4.3 五层体系结构模型

​		五层体系结构是结合了OSI/RM和TCP/IP协议簇的优点而提出来的一个五层结构的模型，但其**仅是为了学术学习研究，没有具体的实际意义**。

​		该体系结构共分为五层，分别是**应用层(Application Layer)**、**传输层(Transport Layer)**、**网络层(Network Layer)**、**数据链路层(Data Link Layer)**和**物理层(Physical Layer)**。其大致功能可以结合OSI参考模型和TCP/IP模型理解。下图展示了三个模型之间的联系。



<img src="src\image-20211020180615606.png" alt="image-20211020180615606" style="zoom: 50%;" />





